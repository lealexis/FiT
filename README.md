# FiT(Fidelity Threshold) protocol
Simulation and implementation of the FiT Link layer quantum communication 
protocol is in the central scrip [simulation_fit_protocol.py](/simulation_fit_protocol.py).
A noisy quantum communication link between Alice and Bob is established 
to enable the distribution of quantum frames from Alice to Bob. The 
quantum frame's payload is either entanglement a.k.a. EPR(Einstein-Podolsky-Rosen)-Pairs 
or superdense encoded information i.e. _EPR-frame_ or _SDC-frame_. The 
classical information that is superdense encoded at Alice and sent to 
Bob is shown bellow and referenced as _mario_.<br/>

<img src="https://github.com/lealexis/FiT/blob/main/assets/mario_original.png" alt="mario-original" style="width:8%; height:auto;"><br/>

Since the generated EPR-Pairs are imperfect, i.e. they are generated by 
the [EPR-pair generator](/epr_gen_class.py) with a fidelity bellow the 
maximum fidelity of _1_. Additionaly, the half of the EPR-pair that belongs
to Bob is sent to him over a noisy quantum channel implemented as an 
[angle &#947; passed to a R-xy gate](/rotational_error_class.py) and 
applied to the EPR-pair-half in distribution. Consequently, The fidelity
of a distributed EPR-pair decreases, depending on its pre-distribution
fidelity and the &#947; angle applied at the R-xy gate; This effect is 
shown in the image bellow, where the percentual decrease of the fidelity
is characterized.<br/>

<img src="https://github.com/lealexis/FiT/blob/main/assets/channel_effect_over_epr.PNG" alt="effect-on-fidelity" style="width:50%; height:auto;"><br/>

Additionaly, the &#947; angle effect on the generated EPR-pairs over 
time is visualized in the image bellow. It can be clearly seen how the 
fidelity of the EPR-pairs decreases depending on the applied &#947; angle.

<img src="https://github.com/lealexis/FiT/blob/main/assets/EPR_BEF_AFT.PNG" alt="effect-on-epr-pairs" style="width:50%; height:auto;"><br/>

When an _EPR-frame_ is distributed, its fidelity is estimated by measuring
some EPR-pairs from the payload[^1]. This is achieved thanks to the 
[epr-frame length estimator](/pred_q.py) and [entanglement manager](/qmem_manager.py).<br/>

Finally, in order to prevent errors when sending superdense encoded 
information from Alice to Bob, a fidelity threshold policy is endorsed.
Any distributed _EPR-frame_, whose estimated fidelity is lower than the
decided threshold fidelity between Alice and Bob, are discarded. This is 
shown in the image bellow, where the distributed EPR-pairs over time are 
characterized by its fidelity and the estimated fideliety for different
_EPR-frames_ is shown clearly diferentiating between acknowledged and 
negative acknowledged _EPR-frames_.<br/> 

<img src="https://github.com/lealexis/FiT/blob/main/assets/result_5.PNG" alt="ack-nack-frames" style="width:50%; height:auto;"><br/>

To depict the consequences of setting a fidelity threshold for the 
distributed _EPR-frames_, the images bellow shows the receiped _mario_ 
with and without threshold. It is clear that a threshold policy on the 
distributed _EPR-frames_ minimizes the amount of errors when the 
distributed entanglement is later used to convei information.

Without Threshold             |  F<sub>thres</sub> = 0.9
:-------------------------:|:-------------------------:
<img src="https://github.com/lealexis/FiT/blob/main/assets/mario_ds_NON_IDEAL_J0.8.png" alt="mario-without-threshold" style="width:30%; height:auto;"> |  <img src="https://github.com/lealexis/FiT/blob/main/assets/mario_ft_NON_IDEAL_0.9.png" alt="mario-0.9-threshold" style="width:30%; height:auto;">

## About the FiT protocol

The FiT protocol is inspired by the classical acknowledgement protocols
where the recipient of a data packet sends an _ack-signal_ if the data packet
was correctly received, otherwise sends an _nack-signal_(negative acknowledgment)
requesting the data packet to be sent again.<br/>

The FiT protocol has two posible _quantum-frames_ to be sended from Alice
to Bob. It can be either an _EPR-frame_ or a _SDC-frame_. They are procesed
thanks to the developed [entanglement manager](/qmem_manager.py), which 
keeps track of the distributed _EPR-frames_ and their position in the 
quantum memory. I.e. in the table bellow is shown an abstraction of a 
quantum memory, where the qubits of different _EPR-frames_ are stored. 
Each stored qubit has an unique _qubit identifier_ which is used to keep
access to it. On the rigth side of the table, is shown an abstraction of
the entanglement manager. For each distributed _EPR-frame_, an _identifier_
is used (a numbers from 0, 1, 2, ...) and the estimated fidelity as well as 
the _qubit-identifiers_ of the qubits composing the _EPR-frame_ are stored.
With this information, the _entanglement manager_ can access specific 
_EPR-frames_ and its information in order to perform actions on them.<br/>

Quantum Memory            |  Entanglement manager
:-------------------------:|:-------------------------:
<img src="https://github.com/lealexis/FiT/blob/main/assets/qmem.PNG" alt="quantum-memory" style="width:30%; height:auto;"> |  <img src="https://github.com/lealexis/FiT/blob/main/assets/qmem_itfc.PNG" alt="ent-manager" style="width:30%; height:auto;">

When an _EPR-frame_ is distributed, it can be stored or dropped, depending
on its estimated fidelity and the fidelity threshold governing the protocol.
Furthermore, the specific _EPR-Feedback_ as well as _EPR-ACK/NACK_ are 
sended between Alice and Bob to fullfil the protocol. This is shown in
the diagram bellow, where the lilac rentangles are functions implemented
in the _entanglement manager_.<br/>

<img src="https://github.com/lealexis/FiT/blob/main/assets/EPR_DIST.png" alt="EPR-frame distribution" style="width:50%; height:auto;"><br/>





[epr-frame erroneous](/assets/EPR_ERR.png)
[sdc-frame distribution](/assets/SDC_DIST.png)
[sdc-frame correction](/assets/SDC_CORRECT.png)  

[^1]: Axel Dahlberg, Matthew Skrzypczyk, Tim Coopmans, Leon Wubben, Filip Rozpędek, Matteo Pompili, Arian Stolk, Przemysław Pawełczak, Robert Knegjens, Julio de Oliveira Filho, Ronald Hanson, and Stephanie Wehner. 2019. A link layer protocol for quantum networks. In Proceedings of the ACM Special Interest Group on Data Communication (SIGCOMM '19). Association for Computing Machinery, New York, NY, USA, 159–173. https://doi.org/10.1145/3341302.3342070